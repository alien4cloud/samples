# Package contents
Tests components list 
- loadtest.jmx :  JMeter scenario
   - Loops on deploy / undeploy worflows (install / unsinstall) of a topology with mock components
   - These mock components generate logs
- loadtest.sh : 
  - sh script which allows you to adjust the variables and launch the scenario.

# Prerequisite

In addition to a functional installation of the A4C / Yorc stack, the execution of the tests requires, ideally on a dedicated machine:
- JDK 8
- JMeter 3.1
- Access to A4C REST API
- The topology used for the tests as well as the associated TOSCA archives must be present in the A4C catalog (the A4C installation usuallly takes care of this).

Usually, these tests are carried out on a monitored stack in order to monitor the response of the various components to the load.

# Configuration

The environment variables below are used by the script and passed to the JMeter scenario to customize its execution.


|Variable|Description|Example|
|-|-|-|
|A4C_LOOP_COUNT|Deploy / undeploy sequence repeat count |10,2|
|A4C_TEST_NAME|Name used for prefixing applications name and used for results file name|MockLoadTest|
|A4C_USER_COUNT|The number of users aka threads numbers started in parallel.|1,2,10|
|JMETER_HOME|JMeter installation directory|/opt/jmeter/apache-jmeter|
|JMETER_RESULT_DIR|Directory for results files ||
|A4C_PROTOCOL|URL scheme for A4C call|http,https|
|A4C_IP|A4C IP address to reach A4C||
|A4C_PORT|A4C port to reach A4C|8088,80,443|
|A4C_BASE|URL context path to  reach A4C||
|A4C_USR|User name to login to A4C|admin|
|A4C_PWD|Password to login to A4C||
|A4C_TEARDOWN|When sets to false, applications are not undeployed after being deployed. Set to false will test numerous applications in dashboard|true,false|
|A4C_TEMPLATE|Archive full file name(aka `<archive name>`Â : `<version>`) of used topology template used for creating applications.|3MockWithRel:2.1.0-SNAPSHOT|
|JMETER_PLAN|Fullpath JMX file Jmeter scenario|/opt/jmeter/loadtests/application.jmx|


# Results

If `A4C_TEST_NAME` value is "MockLoadTest", 3 files in `JMETER_RESULT_DIR` will be generated by JMX scenario  :
- MockLoadTest.jtl: JMeter outputs
- MockLoadTest.log: scenario logs
- MockLoadTest-startUp.csv: results at CSV format
- ApplicationName:  application name
- Status: deployment status at the end of the deployment
o StartDate: deployment start date
o Duration_in_sec: deployment duration